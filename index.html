<!DOCTYPE html>
<html lang="it">
<head>
    
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Luigi Vacchelli</title>
  <link rel="stylesheet" href="stile.css"/>
  
  <link rel="preload" href="logos/loaderlogo.png" as="image">
  <link rel="preload" href="./fonts/Kirome/Kirome.woff2" as="font" type="font/woff2" crossorigin>
  
  <!-- Favicon -->
  <link rel="icon" type="image/png" href="favicon/favicon-96x96.png" sizes="96x96" />
  <link rel="icon" type="image/svg+xml" href="favicon/favicon.svg" />
  <link rel="shortcut icon" href="favicon/favicon.ico" />
  <link rel="apple-touch-icon" sizes="180x180" href="favicon/apple-touch-icon.png" />
  <meta name="apple-mobile-web-app-title" content="MyWebSite" />
  <link rel="manifest" href="favicon/site.webmanifest" />
  
</head>
<body>
    <!-- Preloader Start -->
      <div id="preloader">
        <div class="preloader-content">
          <img src="logos/loaderlogo.png" alt="Loading..." class="loader-icon">
              <p data-i18n-key="welcomeMessage">Questo sito richiede l'accesso alla webcam per essere più bello. <br> Non fate i timidi!</p>
        </div>
      </div>
      <!-- Preloader End -->

<!-- Header -->
<div class="page-header">
  <div class="header-left">lv</div>
  <div class="header-right">
      <label for="about-toggle" class="about-toggle" data-i18n-key="aboutLink">chisono</label>
  </div>
</div>

<!-- Checkbox che controlla l’overlay -->
<input type="checkbox" id="about-toggle" class="about-checkbox" hidden>
    
    <!-- Overlay con bio -->
    <div class="about-overlay">
        <label for="about-toggle" class="about-background"></label> <!-- sfondo cliccabile -->
        <div class="about-card">
            <img src="lv/lvjvc.jpg" class="about-image" alt="">
                <div class="webcam-container">
                    <video id="webcam" autoplay muted playsinline></video>
                </div>
        </div>
        <div class="about-title-box">
            <div class="text-row">
                <div class="word word1">HEART</div>
                <div class="word word2">IS</div>
                <div class="word word3">IN</div>
                <div class="word word4">GENOA</div>
            </div>
            <div class="text-row">
                <div class="word word1">BODY</div>
                <div class="word word2">IS</div>
                <div class="word word3">IN</div>
                <div class="word word4">ROME</div>
            </div>
            <div class="text-row">
                <div class="word word1">MIND</div>
                <div class="word word2">IS</div>
                <div class="word word3">IN</div>
                <div class="word word4">HEAVEN</div>
            </div>
        </div>
    </div>
    
    <!-- Galleria -->
    <div class="container">
        <div class="column left">
            <div class="media-link"><img src="mainpage/pictures/bw/lores/frame.jpg" alt=""></div>
            <div class="media-link"><video autoplay loop muted playsinline src="mainpage/graphics/hires/ghosts.mp4"></video></div>
            <div class="media-link"><img src="mainpage/pictures/c41/lores/edera.jpg" alt=""></div>
            <div class="media-link"><img src="mainpage/pictures/bw/lores/ambulance.jpg" alt=""></div>
            <div class="media-link"><img src="mainpage/pictures/bw/lores/tent.jpg" alt=""></div>
            <div class="media-link"><img src="mainpage/pictures/c41/lores/sea.jpg" alt=""></div>
            <div class="media-link"><video autoplay loop muted playsinline src="mainpage/videos/hires/sun.mp4"></video></div>
            <div class="media-link"><img src="mainpage/pictures/bw/lores/wip.jpg" alt=""></div>
            <div class="media-link"><img src="mainpage/pictures/bw/lores/tube.jpg" alt=""></div>
        </div>
        <div class="column right">
            <div class="media-link"><img src="mainpage/pictures/c41/lores/track.jpg" alt=""></div>
            <div class="media-link"><img src="mainpage/pictures/bw/lores/bike.jpg" alt=""></div>
            <div class="media-link"><video autoplay loop muted playsinline src="mainpage/videos/hires/flares.mp4"></video></div>
            <div class="media-link"><img src="mainpage/pictures/bw/lores/mirrors.jpg" alt=""></div>
            <div class="media-link"><img src="mainpage/pictures/c41/lores/rock.jpg" alt=""></div>
            <div class="media-link"><img src="mainpage/scans/cat.jpg" alt=""></div>
            <div class="media-link"><img src="mainpage/pictures/c41/lores/pool.jpg" alt=""></div>
            <div class="media-link"><img src="mainpage/pictures/peter/lores/peter1.jpg" data-gallery="mainpage/pictures/peter/lores/peter2.jpg,mainpage/pictures/peter/lores/peter3.jpg,mainpage/pictures/peter/lores/peter4.jpg,mainpage/pictures/peter/lores/peter5.jpg" alt=""></div>
            <div class="media-link"><img src="mainpage/pictures/bw/lores/balls.jpg" alt=""></div>
            <div class="media-link"><img src="mainpage/pictures/c41/lores/greenhand.jpg" alt=""></div>
            <div class="media-link"><img src="mainpage/pictures/bw/lores/web.jpg" alt=""></div>
        </div>
    </div>
    
    <!-- JavaScript -->
    <script>
        // --- DICTIONARY FOR TRANSLATIONS ---
        const translations = {
            'en': {
                welcomeMessage: "This site uses your webcam to enhance the experience. <br> Please don't be shy!",
                aboutLink: "whoami"
            },
            'it': {
                welcomeMessage: "Questo sito richiede l'accesso alla webcam per essere più bello. <br> Non fate i timidi!",
                aboutLink: "chisono"
            }
        };

        // --- FUNCTION DEFINITIONS  ---

        function translatePage() {
            const userLang = navigator.language.substring(0, 2);
            const language = userLang === 'it' ? 'it' : 'en';
            document.querySelectorAll('[data-i18n-key]').forEach(element => {
                const key = element.dataset.i18nKey;
                const translation = translations[language][key];
                if (translation !== undefined) {
                    element.innerHTML = translation;
                }
            });
        }

        function requestWebcamAccess() {
            navigator.mediaDevices.getUserMedia({ video: true })
                .then(stream => {
                    const video = document.getElementById('webcam');
                    if (video) { video.srcObject = stream; }
                })
                .catch(error => { console.log("Webcam access was not granted:", error.name); });
        }

        function setupImageGallery() {
            document.querySelectorAll('.media-link img').forEach(img => {
                const originalSrc = img.src;
                const gallery = img.dataset.gallery ? img.dataset.gallery.split(',') : [];
                let index = 0;
                img.addEventListener('click', () => {
                    if (gallery.length === 0) return;
                    index = (index + 1) % (gallery.length + 1);
                    img.src = index === 0 ? originalSrc : gallery[index - 1];
                });
            });
        }

        // --- NEW, IMPROVED MAIN EXECUTION ---

        // This event fires as soon as the HTML is ready.
        document.addEventListener('DOMContentLoaded', () => {
            // Task 1: Make the preloader content visible.
            document.querySelector('.preloader-content').classList.add('ready');

            // Task 2: Run functions that only need the HTML to exist.
            translatePage();
            setupImageGallery();
        });

        // This event fires ONLY when ALL content (images, videos, fonts) is fully loaded.
        window.addEventListener('load', () => {
            const preloader = document.getElementById('preloader');
            const pageHeader = document.querySelector('.page-header');
            const mainContainer = document.querySelector('.container');

            // Hide the preloader now that everything is ready.
            preloader.classList.add('hidden');

            // Show the main content.
            pageHeader.classList.add('visible');
            mainContainer.classList.add('visible');
            
            // Request webcam access now that the page is visible.
            requestWebcamAccess();
        });
    </script>
    
</body>
</html>
